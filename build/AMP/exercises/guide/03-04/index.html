
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Cloudera Education">
      
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>03-04 Beyond Airflow for Spark Jobs - ADMIN-238: Just Enough Kubernetes</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#03-04-beyond-airflow-for-spark-jobs" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="ADMIN-238: Just Enough Kubernetes" class="md-header__button md-logo" aria-label="ADMIN-238: Just Enough Kubernetes" data-md-component="logo">
      
  <img src="../../assets/images/logo-cloudera-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ADMIN-238: Just Enough Kubernetes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              03-04 Beyond Airflow for Spark Jobs
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="pink"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="ADMIN-238: Just Enough Kubernetes" class="md-nav__button md-logo" aria-label="ADMIN-238: Just Enough Kubernetes" data-md-component="logo">
      
  <img src="../../assets/images/logo-cloudera-white.svg" alt="logo">

    </a>
    ADMIN-238: Just Enough Kubernetes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Course Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Table of Contents
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    01 Course Introduction
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            01 Course Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-01/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01-01 Course Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-02/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01-02 Getting Aboard
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    02 Get Aboard
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            02 Get Aboard
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-01/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02-01 Get Aboard
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-02/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02-02 Get Aboard
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-03/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02-03 Bookmarking Cloudera Resources
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    03 Design Principles for Kubernetes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            03 Design Principles for Kubernetes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-01/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    03-01 Design Principles for Kubernetes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-02/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    03-02 Reviewing Kubernetes Documentation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    04 Access and Interact
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            04 Access and Interact
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-01/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    04-01 Access and Interact
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-02/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    04-02 Installing minikube for macOS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-03/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    04-03 Installing minikube for Windows
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-04/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    04-04 Running minikube
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    05 Microservices
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            05 Microservices
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-01/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    05-01 Microservices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-02/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    05-02 Running Docker Commands
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-03/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    05-03 Building a Microservice
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    06 Architecture for Kubernetes Resources
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            06 Architecture for Kubernetes Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-01/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    06-01 Architecture for Kubernetes Resources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-02/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    06-02 Architecture for Kubernetes Resources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-03/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    06-03 Running Pods and Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-04/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    06-04 Inspecting the Kubernetes Dashboard
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    07 Kubernetes Manifest Files
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            07 Kubernetes Manifest Files
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-01/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    07-01 Kubernetes Manifest Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-02/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    07-02 Creating Deployments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-03/README.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    07-03 Inspecting Deployments
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    08 Architecture for Kubernetes Cluster
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            08 Architecture for Kubernetes Cluster
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-01/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    08-01 Architecture for Kubernetes Cluster
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-02/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    08-02 Architecture for Kubernetes Cluster
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    09 Architecture for Kubernetes Control Plane
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            09 Architecture for Kubernetes Control Plane
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09-01/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    09-01 Architecture for Kubernetes Control Plane
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09-02/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    09-02 Inspecting the Control Plane
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    10 Next Steps
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            10 Next Steps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10-01/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    10-01 Next Steps
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Appendix-A Cloudera Support
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            Appendix-A Cloudera Support
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A-01/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    A-01 Cloudera Support
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A-02/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    A-02 Bookmarking Cloudera Resources
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#using-the-cdwrunoperator" class="md-nav__link">
    <span class="md-ellipsis">
      Using the CDWRunOperator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-setup-cdw" class="md-nav__link">
    <span class="md-ellipsis">
      1. Setup CDW
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-setup-cde" class="md-nav__link">
    <span class="md-ellipsis">
      2. Setup CDE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-review-the-dag-python-file" class="md-nav__link">
    <span class="md-ellipsis">
      3. Review the DAG Python file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-create-a-new-airflow-cde-job" class="md-nav__link">
    <span class="md-ellipsis">
      4. Create a new Airflow CDE Job
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-printing-context-variables-with-the-bashoperator" class="md-nav__link">
    <span class="md-ellipsis">
      5. Printing Context Variables with the BashOperator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-review-the-dag-python-file" class="md-nav__link">
    <span class="md-ellipsis">
      6. Review the DAG python file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-using-the-python-operator" class="md-nav__link">
    <span class="md-ellipsis">
      7. Using the Python Operator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-end-of-the-exercise" class="md-nav__link">
    <span class="md-ellipsis">
      8. End of the Exercise
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="03-04-beyond-airflow-for-spark-jobs">03-04 Beyond Airflow for Spark Jobs</h1>
<h3 id="using-the-cdwrunoperator">Using the CDWRunOperator</h3>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The <em>CDWRunOperator</em> was contributed by Cloudera in order to orchestrate CDW queries with Airflow.</p>
</div>
<h3 id="1-setup-cdw">1. Setup CDW  <a name="BAK6UClQddSRZPx-zbH7j"></a></h3>
<p>Before we can use it in the DAG we need to connect Airflow to CDW. To complete these steps, you must have access to a CDW virtual warehouse. CDE currently supports CDW operations for ETL workloads in Apache Hive virtual warehouses. To determine the CDW hostname to use for the connection:</p>
<h4 id="11-click-on-menu">1.1. Click on Menu  <a name="OlJQdjH32Ob7u9SdUBjFZ"></a></h4>
<p>Select the Menu option by clicking on the 9 dots. </p>
<p><a class="glightbox" href="images/step-1.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Click on Menu" src="images/step-1.png" /></a></p>
<h4 id="12-select-data-warehouse">1.2. Select Data Warehouse  <a name="cTKRMc3hRsIZICObI5DAb"></a></h4>
<p>Navigate to the Cloudera Data Warehouse Overview page by clicking the Data Warehouse tile in the Cloudera management console.</p>
<p><a class="glightbox" href="images/step-2.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Select Data Warehouse" src="images/step-2.png" /></a></p>
<h4 id="13-view-the-environment">1.3. View the environment  <a name="WRDvjTErouo8jsLDTA_Ka"></a></h4>
<p>In the Virtual Warehouses column, find the warehouse you want to connect to. In our case, it would be <strong><em>[vw-hive-{class-ID}].</em></strong></p>
<p><a class="glightbox" href="images/step-3.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="View the environment" src="images/step-3.png" /></a></p>
<h4 id="14-notice-the-status">1.4. Notice the status  <a name="h0YfKitzF_M-xCPX4oU3e"></a></h4>
<p>Virtual Warehouse has been configured to auto-suspend every 300 seconds and it will probably go in the stopped state. The stopped status of virtual warehouse will not affect the exercise. </p>
<p><a class="glightbox" href="images/step-4.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Notice the status" src="images/step-4.png" /></a></p>
<h4 id="15-copy-jdbc-url">1.5. Copy JDBC URL  <a name="h1fljPfBxtOaFalLaNOSm"></a></h4>
<p>Click the three-dot menu for the selected warehouse, and then click Copy JDBC URL.</p>
<p><a class="glightbox" href="images/step-5.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Copy JDBC URL" src="images/step-5.png" /></a></p>
<h4 id="16-note-the-hostname">1.6. Note the hostname  <a name="8DZzLORVPKVtlLDD6cNBR"></a></h4>
<p>Paste the URL into a text editor, and make note of the hostname.</p>
<p>For example, starting with the following URL the hostname is shown below:</p>
<div class="highlight"><pre><span></span><code>Original URL: jdbc:hive2://hs2-vw-hive-250204.dw-devops-570-class-250204.fc0b-8n9t.cloudera.site/default;transportMode=http;httpPath=cliservice;socketTimeout=60;ssl=true;retries=3;

Hostname: hs2-vw-hive-250204.dw-devops-570-class-250204.fc0b-8n9t.cloudera.site/
</code></pre></div>
<p><a class="glightbox" href="images/step-6.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Note the hostname" src="images/step-6.png" /></a></p>
<h3 id="2-setup-cde">2. Setup CDE  <a name="e6OMp8XOa1434Jak6A7aK"></a></h3>
<h4 id="21-click-on-menu">2.1. Click on Menu  <a name="AaJ14znMKfMsY156KdiIs"></a></h4>
<p>Select the Menu option by clicking on the 9 dots.</p>
<p><a class="glightbox" href="images/step-8.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Click on Menu" src="images/step-8.png" /></a></p>
<h4 id="22-select-data-engineering">2.2. Select Data Engineering  <a name="0GrcV4pnGC3ImJC2zbALe"></a></h4>
<p>Navigate to the Cloudera Data Engineering Overview page by clicking the Data Engineering tile in the Cloudera management console.</p>
<p><a class="glightbox" href="images/step-9.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Select Data Engineering" src="images/step-9.png" /></a></p>
<h4 id="23-select-administration">2.3. Select Administration   <a name="SWc1wKBF_0Heh78NxNtHh"></a></h4>
<p>Navigate to the main menu and select Administration option from the panel. </p>
<p><a class="glightbox" href="images/step-10.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Select Administration " src="images/step-10.png" /></a></p>
<h4 id="24-click-on-cluster-details">2.4. Click on Cluster Details  <a name="XrY30FlO4innHkzIuFAyK"></a></h4>
<p>In the Virtual Clusters column, click Cluster Details for the virtual cluster.</p>
<p><a class="glightbox" href="images/step-11.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Click on Cluster Details" src="images/step-11.png" /></a></p>
<h4 id="25-click-airflow-ui">2.5.  Click AIRFLOW UI  <a name="URBZGGR_8PlzoGXZZb7_4"></a></h4>
<p><a class="glightbox" href="images/step-12.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt=" Click AIRFLOW UI" src="images/step-12.png" /></a></p>
<h4 id="26-click-the-connection-link">2.6. Click the Connection link   <a name="1Bi3WBJZGK96taJTQm3SL"></a></h4>
<p>From the Airflow UI, click the <strong>Connection link</strong> from the Admin menu.</p>
<p><a class="glightbox" href="images/step-13.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Click the Connection link " src="images/step-13.png" /></a></p>
<h4 id="27-add-a-new-record">2.7. Add a new record  <a name="3keysaOKLoJO4bZRoe2bH"></a></h4>
<p>Click the plus sign to add a new record.</p>
<p><a class="glightbox" href="images/step-14.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Add a new record" src="images/step-14.png" /></a></p>
<h4 id="28-fill-in-the-fields">2.8. Fill in the fields  <a name="6Mf4b2tnArL9KIaPxf3ue"></a></h4>
<p>Fill in the following details in the fields</p>
<ul>
<li><strong>Conn Id</strong>: Create a unique connection identifier, such as "<strong><em>cdw_connection_YourCDPUsername</em></strong>".</li>
<li>For ex: <strong><em>cdw_connection_dse_1_250204</em></strong></li>
<li><strong>Conn Type</strong>: Select Hive Client Wrapper.</li>
<li><strong>Host</strong>: Enter the hostname from the JDBC connection URL. Do not enter the full JDBC URL.</li>
<li><strong>Schema</strong>: default</li>
<li><strong>Login</strong>: Enter your workload username</li>
<li><strong>Password</strong>: Enter your workload password.</li>
</ul>
<p>Click <strong>Save</strong>.</p>
<p><a class="glightbox" href="images/step-15.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Fill in the fields" src="images/step-15.png" /></a></p>
<h4 id="29-review-record">2.9. Review record  <a name="q4JlgEyf8HZ26l5ELqNGB"></a></h4>
<div class="admonition success">
<p class="admonition-title">Success</p>
<p>A success message appears confirming a new row being added. </p>
</div>
<p><a class="glightbox" href="images/step-16.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Review record" src="images/step-16.png" /></a></p>
<h3 id="3-review-the-dag-python-file">3. Review the DAG Python file  <a name="S_IgySF9IVFs2yF-Lj2cs"></a></h3>
<p>Now you are ready to use the <em>CDWOperator</em> in your Airflow DAG. In the cde_jobs/ directory, a copy of "firstdag.py" has been made and named "cdw_dag.py" with the following additions. </p>
<h4 id="31-import-operator">3.1. Import Operator  <a name="jZXBhJJI0jE-so66muv75"></a></h4>
<p>At the top, an Operator has been imported along with other import statements.</p>
<div class="highlight"><pre><span></span><code>from cloudera.cdp.airflow.operators.cdw_operator import CDWOperator
</code></pre></div>
<p><a class="glightbox" href="images/step-18.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Import Operator" src="images/step-18.png" /></a></p>
<h4 id="32-add-object">3.2. Add Object  <a name="jzx32dIxU0_F-Yen7AN6T"></a></h4>
<p>At the bottom of the file an instance of the <em>CDWOperator</em> object has been added.</p>
<div class="highlight"><pre><span></span><code>cdw_query = &quot;&quot;&quot;
show databases;
&quot;&quot;&quot;

dw_step3 = CDWOperator(
  task_id=&#39;dataset-etl-cdw&#39;,
  dag=example_dag,
  cli_conn_id=&#39;cdw_connection_YourCDPUsername&#39;,
  hql=cdw_query,
  schema=&#39;default&#39;,
  use_proxy_user=False,
  query_isolation=True
)
</code></pre></div>
<p>Notice that the SQL syntax run in the CDW Virtual Warehouse is declared as a separate variable and then passed to the Operator instance as an argument.</p>
<p><a class="glightbox" href="images/step-19.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Add Object" src="images/step-19.png" /></a></p>
<h4 id="33-update-task-dependencies">3.3.  Update task dependencies  <a name="0heRdPE7hGmHBip39kDEU"></a></h4>
<p>Task dependencies have been updated to include "dw_step3":</p>
<div class="highlight"><pre><span></span><code>spark_step &gt;&gt; shell &gt;&gt; dw_step3
</code></pre></div>
<p><a class="glightbox" href="images/step-20.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt=" Update task dependencies" src="images/step-20.png" /></a></p>
<h4 id="34-update-variables">3.4. Update variables  <a name="SkeVzXaO_KCWQFXVPDXjE"></a></h4>
<p>DAG names are stored in Airflow and must be unique. Therefore, the variable name of the DAG object instance has been changed to "airflow_cdw_dag" and the DAG ID to "dw_dag" as shown below.</p>
<div class="highlight"><pre><span></span><code>airflow_cdw_dag = DAG(
    &#39;dw_dag&#39;,
    default_args=default_args,
    schedule_interval=&#39;@daily&#39;,
    catchup=False,
    is_paused_upon_creation=False
    )
</code></pre></div>
<p>Notice the new DAG variable needs to be updated in each Operator as well. The completed DAG file is included in the cde_jobs folder for your convenience.</p>
<p><a class="glightbox" href="images/step-21.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Update variables" src="images/step-21.png" /></a></p>
<h4 id="35-replace-owner">3.5. Replace Owner  <a name="uIe3i6DNRzSPRFuzOeRHv"></a></h4>
<p>Before moving on, make sure to replace the current value of the 'Owner' with your <strong><em>Y</em></strong><strong><em>ourCDPUsername</em></strong> in the default arguments dictionary.</p>
<p><a class="glightbox" href="images/step-22.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Replace Owner" src="images/step-22.png" /></a></p>
<h4 id="36-replace-spark-job-name">3.6. Replace Spark job name  <a name="ggYl8bC1Q9UtN9f9G7ISZ"></a></h4>
<p>Before moving on, make sure to replace the current value of the 'job_name' with <strong><em>sparksql_YourCDPUsername</em></strong> in spark_step block.</p>
<p><a class="glightbox" href="images/step-23.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Replace Spark job name" src="images/step-23.png" /></a></p>
<h4 id="37-replace-cli-connection-id">3.7. Replace CLI Connection ID  <a name="dfkuly_swXZqhcSdkw8Qf"></a></h4>
<p>Before moving on, make sure to replace the current value of the 'cli_conn_id' with the value <strong><em>cdw_connection_YourCDPUsername </em></strong>used while creating the connection. No other changes are required at this time.</p>
<p><a class="glightbox" href="images/step-24.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Replace CLI Connection ID" src="images/step-24.png" /></a></p>
<h3 id="4-create-a-new-airflow-cde-job">4. Create a new Airflow CDE Job  <a name="XtDT7Cc9nlcD5XqEL-U98"></a></h3>
<h4 id="41-select-jobs">4.1. Select Jobs  <a name="U35AKXNySM8FgSezj4_6H"></a></h4>
<p>Navigate to the Jobs page by clicking on the <strong>Jobs</strong> in the main panel.</p>
<p><a class="glightbox" href="images/step-26.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Select Jobs" src="images/step-26.png" /></a></p>
<h4 id="42-click-on-create-job">4.2. Click on Create Job  <a name="sgOn7UGHNrYDzx_OGRt_t"></a></h4>
<p>Click on <strong>Create Job</strong> to create a new CDE Job.</p>
<p><a class="glightbox" href="images/step-27.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Click on Create Job" src="images/step-27.png" /></a></p>
<h4 id="43-fill-in-the-details">4.3. Fill in the details  <a name="jeWEho-QOGYYYf44s0Rkn"></a></h4>
<ul>
<li><strong>Job Type</strong>: Airflow</li>
<li><strong>Name</strong>: CDWDag_<strong><em>YourCDPUsername</em></strong></li>
<li><strong>Dag File</strong>: File</li>
</ul>
<p>Click on <strong>Upload</strong></p>
<p><a class="glightbox" href="images/step-28.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Fill in the details" src="images/step-28.png" /></a></p>
<h4 id="44-upload-file-to-a-resource">4.4. Upload file to a resource  <a name="hyjGdHihXsnoLc2K_Bshy"></a></h4>
<p>Upload <strong><em>cdw_dag.py</em></strong> to the <strong>firstdag</strong> CDE Resource you created earlier.</p>
<blockquote>
<p>Ensure that you have replaced the current value of the 'Owner' with your CDP Username in the default arguments dictionary. Please refer to Step 2.3 in the previous exercise for details. </p>
</blockquote>
<p>Click on <strong>Upload</strong>.</p>
<p><a class="glightbox" href="images/step-29.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Upload file to a resource" src="images/step-29.png" /></a></p>
<h4 id="45-select-create-and-run">4.5. Select 'Create and Run'  <a name="h73kHlT9qZ_FAIdJBoElc"></a></h4>
<p>Select <strong>Create and Run</strong> button to trigger the job immediately.</p>
<p><a class="glightbox" href="images/step-30.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Select 'Create and Run'" src="images/step-30.png" /></a></p>
<h4 id="46-job-run-in-progress">4.6. Job run in progress  <a name="BsMBrCdDE2FwHp0lnFYW3"></a></h4>
<p>Please wait for a min for job to run</p>
<p><a class="glightbox" href="images/step-31.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Job run in progress" src="images/step-31.png" /></a></p>
<h4 id="47-new-run-is-initiated">4.7. New run is initiated  <a name="hb3FOZQ3JlTUTmZdrBv4t"></a></h4>
<p>A success message appears confirming that a new run with ID has been initiated. </p>
<p><a class="glightbox" href="images/step-32.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="New run is initiated" src="images/step-32.png" /></a></p>
<h4 id="48-review-the-jobs-in-progress">4.8. Review the Jobs in progress  <a name="wETw2hyYbCm3iRTZOU-0P"></a></h4>
<p>Notice that two CDE Jobs are now in progress. One of them is "<em>sparksql_dse_1_250204</em>" (Spark CDE Job) and the other is "<em>CDWDag_dse_1_250204</em>" (Airflow CDE Job). The former has been triggered by the execution of the latter. Wait a few moments and allow for the DAG to complete.</p>
<p><a class="glightbox" href="images/step-33.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Review the Jobs in progress" src="images/step-33.png" /></a></p>
<h4 id="49-click-on-the-dag-link">4.9. Click on the Dag link  <a name="1qVzy244Q3j7slwfZwKaC"></a></h4>
<p>Once the Status column shows the Jobs run as succeeded, click on the "<strong>CDWDag_dse_1_250204</strong>" link to access the Job Run page.</p>
<p><a class="glightbox" href="images/step-34.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Click on the Dag link" src="images/step-34.png" /></a></p>
<h4 id="410-select-the-most-recent-run">4.10. Select the most recent Run  <a name="UvMAEYDLn-C8l1WU8c9ZM"></a></h4>
<p>This page shows each run along with associated logs, execution statistics, and the Airflow UI.</p>
<p>Ensure to select the most recent Run (in the screenshot, the most recent Run ID number is 60)</p>
<p><a class="glightbox" href="images/step-35.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Select the most recent Run" src="images/step-35.png" /></a></p>
<h4 id="411-review-job-run">4.11. Review Job Run  <a name="EG15MdiDxFWMOxm7jsjeW"></a></h4>
<p>Review the Job Run. Notice the run id in the top section of the page. </p>
<p>Click on the Airflow UI tab.</p>
<p><a class="glightbox" href="images/step-36.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Review Job Run" src="images/step-36.png" /></a></p>
<h4 id="412-review-airflow-ui-tab">4.12. Review Airflow UI tab  <a name="rFIZRrrRHiMb1bn71TBVO"></a></h4>
<p>The first landing page lists all tasks along with their status. Notice that the DAG ID, Task ID and Operator columns are populated with the values set in the DAG python files. </p>
<p>Next, click on the back arrow on the left side of the screen to navigate to the Airflow UI DAGs view.</p>
<p><a class="glightbox" href="images/step-37.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Review Airflow UI tab" src="images/step-37.png" /></a></p>
<h4 id="413-explore-dags-view">4.13. Explore DAGs view.  <a name="amRG0W8L7-QGdSIDeKF-k"></a></h4>
<p>From the DAGs view you can:</p>
<ul>
<li>Pause/unpause a DAG</li>
<li>Filter the list of DAGs to show active, paused, or all DAGs</li>
<li>Trigger, refresh, or delete a DAG</li>
<li>Navigate quickly to other DAG-specific pages</li>
</ul>
<p>The DAG name specified in the python file during DAG declaration is <strong>dw_dag</strong>.</p>
<p>Click on it to open the Airflow UI DAG view to drill down with DAG-specific pages.</p>
<p><a class="glightbox" href="images/step-38.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Explore DAGs view." src="images/step-38.png" /></a></p>
<h4 id="414-review-dag">4.14. Review DAG   <a name="JKq1__Q5aYI0SFwhCXE1s"></a></h4>
<p>Here, Airflow provides a number of tabs to increase job observability. Open the Tree View and validate that the job has succeeded.</p>
<p><a class="glightbox" href="images/step-39.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Review DAG " src="images/step-39.png" /></a></p>
<h3 id="5-printing-context-variables-with-the-bashoperator">5. Printing Context Variables with the BashOperator  <a name="nMiCf2xLR1Pp1rAKusSl2"></a></h3>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>When Airflow runs a task, it collects several variables and passes these to the context argument on the execute() method. These variables hold information about the current task.</p>
</div>
<p>Open the "<strong>bash_dag.py</strong>" file and examine the contents. Notice that at lines 52-56 a new instance of the BashOperator has been declared with the following entries:</p>
<div class="highlight"><pre><span></span><code>also_run_this = BashOperator(
    task_id=&#39;also_run_this&#39;,
    dag=bash_airflow_dag,
    bash_command=&#39;echo &quot;yesterday={{ yesterday_ds }} | today={{ ds }}| tomorrow={{ tomorrow_ds }}&quot;&#39;,
)
</code></pre></div>
<p>Above we printed the "yesterday_ds", "ds" and tomorrow_ds" dates. There are many more and you can find the full list <a href="https://airflow.apache.org/docs/apache-airflow/stable/macros-ref.html#default-variables">here</a>.</p>
<p>Variables can also be saved and reused by other operators. We will explore this in the section on XComs.</p>
<p><a class="glightbox" href="images/step-40.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Printing Context Variables with the BashOperator" src="images/step-40.png" /></a></p>
<h3 id="6-review-the-dag-python-file">6. Review the DAG python file  <a name="7SujSS9ENHgh27rc9E41G"></a></h3>
<p>Now you are ready to use the <em>CDWOperator</em> in your Airflow DAG. In the cde_jobs/ directory, a copy of "cdw_dag.py" has been made and named "py_dag.py" with the following additions.</p>
<h4 id="61-python-operator">6.1. Python Operator  <a name="e-sO5tsnn_1CcXWLkSVTL"></a></h4>
<p>Lines 60-67 in "py_dag.py" show how to use the operator to print out all Conext Variables in one run.</p>
<div class="highlight"><pre><span></span><code>def _print_context(**context):
   print(context)

print_context = PythonOperator(
    task_id=&quot;print_context&quot;,
    python_callable=_print_context,
    dag=dag,
)
</code></pre></div>
<p><a class="glightbox" href="images/step-42.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Python Operator" src="images/step-42.png" /></a></p>
<h4 id="62-replace-owner">6.2. Replace Owner  <a name="EbVglcF5bdO2DdIXwPFeH"></a></h4>
<p>Before moving on, make sure to replace the current value of the 'Owner' with your <strong><em>Y</em></strong><strong><em>ourCDPUsername</em></strong> in the default arguments dictionary.</p>
<p><a class="glightbox" href="images/step-43.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Replace Owner" src="images/step-43.png" /></a></p>
<h4 id="63-replace-spark-job-name">6.3. Replace Spark job name  <a name="SqmO0_CM5-OtIcK_TgEzH"></a></h4>
<p>Before moving on, make sure to replace the current value of the 'job_name' with <strong><em>sparksql_YourCDPUsername</em></strong> in spark_step block.</p>
<p><a class="glightbox" href="images/step-44.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Replace Spark job name" src="images/step-44.png" /></a></p>
<h4 id="64-replace-cli-connection-id">6.4. Replace CLI Connection ID  <a name="pS2tG_fbPxKHZSbLpFbe4"></a></h4>
<p>Before moving on, make sure to replace the current value of the 'cli_conn_id' with the value <strong><em>cdw_connection_YourCDPUsername </em></strong>used while creating the connection. No other changes are required at this time.</p>
<p><a class="glightbox" href="images/step-45.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Replace CLI Connection ID" src="images/step-45.png" /></a></p>
<h3 id="7-using-the-python-operator">7. Using the Python Operator  <a name="L9SJ1JcqPL5iGzOqYWAvQ"></a></h3>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The <em>PythonOperator</em> allows you to run Python code inside the DAG. This is particularly helpful as it allows you to customize your DAG logic in a variety of ways.</p>
</div>
<p>The <em>PythonOperator</em> requires implementing a callable inside the DAG file. Then, the method is called from the operator.</p>
<h4 id="71-select-jobs">7.1. Select Jobs   <a name="-sx33gA2EDMSAcFJfNcYl"></a></h4>
<p>Navigate to the Jobs page by clicking on the <strong>Jobs</strong> in the main panel.</p>
<p><a class="glightbox" href="images/step-47.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Select Jobs " src="images/step-47.png" /></a></p>
<h4 id="72-click-on-create-job">7.2. Click on Create Job  <a name="azDqGj-WjpLvMJGS3CI4L"></a></h4>
<p>Click on <strong>Create Job</strong> to create a new CDE Job.</p>
<p><a class="glightbox" href="images/step-48.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Click on Create Job" src="images/step-48.png" /></a></p>
<h4 id="73-fill-in-the-details">7.3. Fill in the details   <a name="RvXgAMui37F6vKSDjdKvL"></a></h4>
<ul>
<li><strong>Job Type</strong>: Airflow</li>
<li><strong>Name</strong>: pydag_<strong><em>YourCDPUsername</em></strong></li>
<li><strong>Dag File</strong>: File</li>
<li>Upload <strong><em>py_dag.py</em></strong> to the <strong>firstdag</strong> CDE Resource you created earlier.</li>
</ul>
<p>Select '<strong>Create and Run</strong>' button to trigger the job immediately.</p>
<p><a class="glightbox" href="images/step-49.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Fill in the details " src="images/step-49.png" /></a></p>
<h4 id="74-job-run-in-progress">7.4. Job run in progress  <a name="zIZaXOP0KQL71io5tYPY_"></a></h4>
<p>Please wait for a min for job to run</p>
<p><a class="glightbox" href="images/step-50.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Job run in progress" src="images/step-50.png" /></a></p>
<h4 id="75-new-run-is-initiated">7.5. New run is initiated  <a name="I8lmPC0opVSq20mldj6Vx"></a></h4>
<p>A success message appears confirming that a new run with ID has been initiated. </p>
<p><a class="glightbox" href="images/step-51.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="New run is initiated" src="images/step-51.png" /></a></p>
<h4 id="76-review-the-jobs-in-progress">7.6. Review the Jobs in progress  <a name="0K1i92pgxtqr7dZos2fMV"></a></h4>
<p>Notice that two CDE Jobs are now in progress. One of them is "<em>sparksql</em><em>_dse_1_250204</em>" (Spark CDE Job) and the other is "<em>pydag</em><em>_dse_1_250204</em>" (Airflow CDE Job). The former has been triggered by the execution of the latter. Wait a few moments and allow for the DAG to complete.</p>
<p><a class="glightbox" href="images/step-52.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Review the Jobs in progress" src="images/step-52.png" /></a></p>
<h4 id="77-click-on-the-dag-link">7.7. Click on the Dag link  <a name="1Uv9vPuCvnPwmfejh_ci1"></a></h4>
<p>Once the Status column shows the Jobs run as succeeded, click on the "<strong>pydag</strong><strong>_dse_1_250204</strong>" link to access the Job Run page.</p>
<p><a class="glightbox" href="images/step-53.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Click on the Dag link" src="images/step-53.png" /></a></p>
<h4 id="78-select-the-most-recent-run">7.8. Select the most recent Run  <a name="-zzvpZQC7CKpTj1pxQ-Hr"></a></h4>
<p>This page shows each run along with associated logs, execution statistics, and the Airflow UI.</p>
<p>Ensure to select the most recent Run (in the screenshot, the most recent Run ID number is 68)</p>
<p><a class="glightbox" href="images/step-54.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Select the most recent Run" src="images/step-54.png" /></a></p>
<h4 id="79-review-job-run">7.9. Review Job Run  <a name="WtdyPvLg-682R6r1dIONe"></a></h4>
<p>Review the Job Run. Notice the run id in the top section of the page. </p>
<p>Click on the Logs tab.</p>
<p><a class="glightbox" href="images/step-55.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Review Job Run" src="images/step-55.png" /></a></p>
<h4 id="710-select-dag-task">7.10. Select DAG Task  <a name="NQAwSOEXwiQBU9yrZ03ta"></a></h4>
<p>Ensure to select the correct Airflow task which in this case is "<strong>print_context</strong>":</p>
<p><a class="glightbox" href="images/step-56.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Select DAG Task" src="images/step-56.png" /></a></p>
<h4 id="711-review-dag-task">7.11. Review DAG Task  <a name="oFvylIjIMfYD8l8DZVWJQ"></a></h4>
<p>Review the <strong><em>print_context</em></strong> task</p>
<p>Scroll to the bottom and validate the output.</p>
<p><a class="glightbox" href="images/step-57.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Review DAG Task" src="images/step-57.png" /></a></p>
<h3 id="8-end-of-the-exercise">8. End of the Exercise  <a name="nUBI-WGTFsYtWZ-vICbPs"></a></h3>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Cloudera Inc. 2025
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "content.code.copy"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>