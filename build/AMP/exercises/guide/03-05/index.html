
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Cloudera Education">
      
      
      
        <link rel="prev" href="../03-04/index.html">
      
      
        <link rel="next" href="../04-01/index.html">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>03-05 More Airflow DAG Features - DENG-259: Building Solutions with Cloudera Data Services</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#03-05-more-airflow-dag-features" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="DENG-259: Building Solutions with Cloudera Data Services" class="md-header__button md-logo" aria-label="DENG-259: Building Solutions with Cloudera Data Services" data-md-component="logo">
      
  <img src="../../assets/images/logo-cloudera-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DENG-259: Building Solutions with Cloudera Data Services
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              03-05 More Airflow DAG Features
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="pink"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="DENG-259: Building Solutions with Cloudera Data Services" class="md-nav__button md-logo" aria-label="DENG-259: Building Solutions with Cloudera Data Services" data-md-component="logo">
      
  <img src="../../assets/images/logo-cloudera-white.svg" alt="logo">

    </a>
    DENG-259: Building Solutions with Cloudera Data Services
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Course Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Table of Contents
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    01 Get Aboard
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            01 Get Aboard
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-01/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01-01 Get Aboard
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-02/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01-02 Getting Aboard
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    02 Using Cloudera Data Flow
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            02 Using Cloudera Data Flow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-01/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02-01 Using Cloudera Data Flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-02/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02-02 Accessing Environment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-03/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02-03 Define Workload Password
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-04/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02-04 Verify permissions in Apache Ranger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-05/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02-05 Create a Flow using Flow Designer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-06/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02-06 Testing the flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-07/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02-07 Moving the flow to the flow catalog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-08/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02-08 Migrating Existing Data Flows to CDF-PC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-09/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02-09 Managing KeyTabs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-10/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02-10 Working on SQL Steam Builder Project
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    03 Using Cloudera Data Engineering - Airflow
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            03 Using Cloudera Data Engineering - Airflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-01/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    03-01 Using Cloudera Data Engineering - Airflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-02/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    03-02 Accessing Environment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-03/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    03-03 Building Your First CDE Airflow DAG
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-04/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    03-04 Beyond Airflow for Spark Jobs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    03-05 More Airflow DAG Features
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="index.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    03-05 More Airflow DAG Features
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-creating-an-http-airflow-connection" class="md-nav__link">
    <span class="md-ellipsis">
      1. Creating an HTTP Airflow Connection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-creating-airflow-variables" class="md-nav__link">
    <span class="md-ellipsis">
      2. Creating Airflow Variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-working-with-the-dag" class="md-nav__link">
    <span class="md-ellipsis">
      3. Working with the DAG
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-create-a-new-airflow-cde-job" class="md-nav__link">
    <span class="md-ellipsis">
      4. Create a new Airflow CDE Job
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-using-xcoms" class="md-nav__link">
    <span class="md-ellipsis">
      5. Using XComs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-create-a-new-airflow-cde-job" class="md-nav__link">
    <span class="md-ellipsis">
      6. Create a new Airflow CDE Job
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-end-of-the-exercise" class="md-nav__link">
    <span class="md-ellipsis">
      7. End of the Exercise
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    04 Using Cloudera Data Warehouse
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            04 Using Cloudera Data Warehouse
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-01/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    04-01 Using Cloudera Data Warehouse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-02/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    04-02 Introdction and Access
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-03/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    04-03 CDW raw layer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-04/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    04-04 Datalakehouse Hive and Iceberg
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-05/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    04-05 Performance Optimization & Lakehouse Maintenance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-06/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    04-06 Data Visualization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    05 Using Cloudera AI
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            05 Using Cloudera AI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-01/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    05-01 Using Cloudera AI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-02/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    05-02 MLOps in Cloudera AI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    06 Integrating Cloudera Data Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            06 Integrating Cloudera Data Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-01/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    06-01 Use Case: Stock Data Analysis Using Cloudera
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-02/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    06-02 End-to-End Stock Data Processing with Cloudera
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    07 Course Summary
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            07 Course Summary
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-01/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    07-01 Course Summary
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-creating-an-http-airflow-connection" class="md-nav__link">
    <span class="md-ellipsis">
      1. Creating an HTTP Airflow Connection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-creating-airflow-variables" class="md-nav__link">
    <span class="md-ellipsis">
      2. Creating Airflow Variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-working-with-the-dag" class="md-nav__link">
    <span class="md-ellipsis">
      3. Working with the DAG
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-create-a-new-airflow-cde-job" class="md-nav__link">
    <span class="md-ellipsis">
      4. Create a new Airflow CDE Job
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-using-xcoms" class="md-nav__link">
    <span class="md-ellipsis">
      5. Using XComs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-create-a-new-airflow-cde-job" class="md-nav__link">
    <span class="md-ellipsis">
      6. Create a new Airflow CDE Job
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-end-of-the-exercise" class="md-nav__link">
    <span class="md-ellipsis">
      7. End of the Exercise
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="03-05-more-airflow-dag-features">03-05 More Airflow DAG Features</h1>
<h4 id="using-the-simplehttpoperator">Using the <strong><em>SimpleHttpOperator</em></strong></h4>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>You can use the <em>SimpleHttpOperator</em> to call HTTP requests and get the response text back. The Operator can help when you need to interact with 3rd party systems, APIs, and perform actions based on complex control flow logic.</p>
</div>
<p>In the following example we will send a request to the Chuck Norris API from the Airflow DAG. Before updating the DAG file, we need to set up a new Airflow Connection and Airflow Variables.</p>
<h3 id="1-creating-an-http-airflow-connection">1. Creating an HTTP Airflow Connection  <a name="VKMOR-taFpCTJsmjCJ-2L"></a></h3>
<h4 id="11-select-administration">1.1. Select Administration   <a name="auMxVE6h7z6uAuI8QocnZ"></a></h4>
<p>Navigate to the main menu and select Administration option from the panel. </p>
<p><a class="glightbox" href="images/step-1.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Select Administration " src="images/step-1.png" /></a></p>
<h4 id="12-click-on-cluster-details">1.2. Click on Cluster Details  <a name="5uAoR529gh6ouZTvjL5nA"></a></h4>
<p>In the Virtual Clusters column, click Cluster Details for the virtual cluster.</p>
<p><a class="glightbox" href="images/step-2.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Click on Cluster Details" src="images/step-2.png" /></a></p>
<h4 id="13-click-airflow-ui">1.3.  Click AIRFLOW UI  <a name="DC_ls7H3_GtuVITZkCLHy"></a></h4>
<p><a class="glightbox" href="images/step-3.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt=" Click AIRFLOW UI" src="images/step-3.png" /></a></p>
<h4 id="14-click-the-connection-link">1.4. Click the Connection link   <a name="NGDF1P_H8QcU1OuAWf06o"></a></h4>
<p>From the Airflow UI, click the <strong>Connection link</strong> from the Admin menu.</p>
<p><a class="glightbox" href="images/step-4.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Click the Connection link " src="images/step-4.png" /></a></p>
<h4 id="15-add-a-new-record">1.5. Add a new record  <a name="A14xRLRD9fuJ3KBcsYapp"></a></h4>
<p>Click the plus sign to add a new record.</p>
<p><a class="glightbox" href="images/step-5.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Add a new record" src="images/step-5.png" /></a></p>
<h4 id="16-fill-in-the-fields">1.6. Fill in the fields   <a name="Q2PwSq5-S1U1kYoQTeTz8"></a></h4>
<p>Configure the connection by entering the following values for the following parameters. Leave the remaining entries blank.</p>
<ul>
<li><strong>Connection ID</strong>: chuck_norris_connection_<strong><em>YourCDPUsername</em></strong></li>
<li><strong>Connection Type</strong>: HTTP</li>
<li><strong>Host</strong>: https://matchilling-chuck-norris-jokes-v1.p.rapidapi.com</li>
</ul>
<p>Click <strong>Save</strong>.</p>
<p><a class="glightbox" href="images/step-6.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Fill in the fields " src="images/step-6.png" /></a></p>
<h4 id="17-review-record">1.7. Review record   <a name="7lt2qJ15-AgNzj07oZ3T-"></a></h4>
<p>A success message appears confirming a new row being added. </p>
<p><a class="glightbox" href="images/step-7.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Review record " src="images/step-7.png" /></a></p>
<h3 id="2-creating-airflow-variables">2. Creating Airflow Variables  <a name="VUy56BvzT3NDEE-lSMs-8"></a></h3>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Airflow Variables allow you to parameterize your operators. Airflow Variables are used as environment variables for the DAG. Therefore, if you are looking to temporarily store operator results in the DAG and pass values to downstream operators you should use XComs (shown in the next section).</p>
</div>
<p>In our example, we will use them to pass an API KEY and HOST value to the <em>SimpleHttpOperator</em> below. To set up Airflow Variables, navigate back to the CDE Virtual Cluster Service Details page and open the Airflow UI.</p>
<h4 id="21-click-the-connection-link">2.1. Click the Connection link   <a name="v20JCtBkAxHSMcPw3EkD8"></a></h4>
<p>From the Airflow UI, click on the "<strong>Variables</strong>" tab under the "Admin" drop down at the top of the page.</p>
<p><a class="glightbox" href="images/step-9.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Click the Connection link " src="images/step-9.png" /></a></p>
<h4 id="22-add-a-new-record">2.2. Add a new record  <a name="gkh-bdTncwt1zTyc4MLt2"></a></h4>
<p>Click the plus sign to add a new record.</p>
<p><a class="glightbox" href="images/step-10.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Add a new record" src="images/step-10.png" /></a></p>
<h4 id="23-create-first-variable">2.3. Create first variable   <a name="kQ5taoIgfyTiY6Ip2v04r"></a></h4>
<p>Create a variable with the following entries:</p>
<ul>
<li><strong>Key</strong>: rapids_api_host_<strong><em>YourCDPUsername</em></strong></li>
<li><strong>Value</strong>: matchilling-chuck-norris-jokes-v1.p.rapidapi.com</li>
</ul>
<p>Click <strong>Save</strong></p>
<p><a class="glightbox" href="images/step-11.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Create first variable " src="images/step-11.png" /></a></p>
<h4 id="24-review-new-row">2.4. Review new row  <a name="zNsbVnO2IQe2KE_Mt-rM2"></a></h4>
<div class="admonition success">
<p class="admonition-title">Success</p>
<p>A success message appears confirming that a row has been added. </p>
</div>
<p>Click the plus sign to add a new record.</p>
<p><a class="glightbox" href="images/step-12.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Review new row" src="images/step-12.png" /></a></p>
<h4 id="25-create-second-variable">2.5. Create second variable   <a name="QyK1r17bQKH-7ny2Zw3s1"></a></h4>
<p>Create a new variable with the following entries:</p>
<ul>
<li><strong>Key</strong>: rapids_api_key_<strong><em>YourCDPUsername</em></strong></li>
<li><strong>Value</strong>: f16c49e390msh7e364a479e33b3dp10fff7jsn6bc84b000b75</li>
</ul>
<p>Click <strong>Save</strong></p>
<p><a class="glightbox" href="images/step-13.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Create second variable " src="images/step-13.png" /></a></p>
<h4 id="26-review-second-row">2.6. Review second row  <a name="YGk3rvbDboTDqabzcLsT-"></a></h4>
<div class="admonition success">
<p class="admonition-title">Success</p>
<p>A success message appears confirming that the new row has been added.</p>
</div>
<p><a class="glightbox" href="images/step-14.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Review second row" src="images/step-14.png" /></a></p>
<h3 id="3-working-with-the-dag">3. Working with the DAG  <a name="9opnENXWAExzLfIGZo5uk"></a></h3>
<p>Next, open "http_dag.py" and familiarize yourself with the code. The code relevant to the new operator is used between lines 71 and 92.</p>
<h4 id="31-import-variable">3.1. Import Variable   <a name="4CaM0ewynj6MLJOVT521i"></a></h4>
<p>Notice that at line 11 we are importing the Variable type from the<em> airflow.models</em> module.</p>
<p><a class="glightbox" href="images/step-16.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Import Variable " src="images/step-16.png" /></a></p>
<h4 id="32-create-airflow-variables">3.2. Create Airflow Variables  <a name="Bgm2S_A0ptls-p-sf7CiN"></a></h4>
<p>We are then creating two Airflow Variables at lines 71 and 72.</p>
<p><a class="glightbox" href="images/step-17.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Create Airflow Variables" src="images/step-17.png" /></a></p>
<h4 id="33-map-parameter">3.3. Map parameter  <a name="8uX3PQryxJKjxf1uLbf85"></a></h4>
<p>The "<em>http_conn_id</em>" parameter is mapped to the Connection ID you configured in the prior step.</p>
<p><a class="glightbox" href="images/step-18.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Map parameter" src="images/step-18.png" /></a></p>
<h4 id="34-validate-response">3.4. Validate response  <a name="T4pcG6buEZ5-pIr2LHIbN"></a></h4>
<p>The "<em>response_check</em>" parameter allows you to specify a python method to validate responses. This is the "<em>handle_response</em>" method declared at line 74.</p>
<div class="highlight"><pre><span></span><code>api_host = Variable.get(&quot;rapids_api_host&quot;)
api_key = Variable.get(&quot;rapids_api_key&quot;)

def handle_response(response):
    if response.status_code == 200:
        print(&quot;Received 200 Ok&quot;)
        return True
    else:
        print(&quot;Error&quot;)
        return False

http_task = SimpleHttpOperator(
    task_id=&quot;chuck_norris_task&quot;,
    method=&quot;GET&quot;,
    http_conn_id=&quot;chuck_norris_connection&quot;,
    endpoint=&quot;/jokes/random&quot;,
    headers={&quot;Content-Type&quot;:&quot;application/json&quot;,
            &quot;X-RapidAPI-Key&quot;: api_key,
            &quot;X-RapidAPI-Host&quot;: api_host},
    response_check=lambda response: handle_response(response),
    dag=http_dag
)
</code></pre></div>
<p><a class="glightbox" href="images/step-19.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Validate response" src="images/step-19.png" /></a></p>
<h4 id="35-replace-owner">3.5. Replace Owner  <a name="lHjqs-UOxs_zr8pUvH106"></a></h4>
<p>Make sure to replace the current value of the 'Owner' with your <strong><em>YourCDPUsername</em></strong> in the default arguments dictionary.</p>
<p><a class="glightbox" href="images/step-20.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Replace Owner" src="images/step-20.png" /></a></p>
<h4 id="36-replace-spark-job-name">3.6. Replace Spark job name  <a name="cOArJ-A2i7zzWTvBWawQA"></a></h4>
<p>Make sure to replace the current value of the 'job_name' with <strong><em>sparksql_YourCDPUsername</em></strong> in spark_step block.</p>
<p><a class="glightbox" href="images/step-21.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Replace Spark job name" src="images/step-21.png" /></a></p>
<h4 id="37-replace-cli-connection-id">3.7. Replace CLI Connection ID  <a name="8Gt-77MBAWClQ-UJKOlCp"></a></h4>
<p>Make sure to replace the current value of the 'cli_conn_id' with the value <strong><em>cdw_connection_YourCDPUsername </em></strong>used while creating the connection.</p>
<p><a class="glightbox" href="images/step-22.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Replace CLI Connection ID" src="images/step-22.png" /></a></p>
<h4 id="38-replace-airflow-variables">3.8. Replace Airflow Variables  <a name="Yd8laONZlpUh1WwcO6da1"></a></h4>
<p>Make sure to replace the current value of the 'api_host' and api_key with the value <strong><em>rapids_api_host_YourCDPUsername </em></strong>and <strong><em>rapids_api_key_YourCDPUsername </em></strong>used while creating the variables.</p>
<p><a class="glightbox" href="images/step-23.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Replace Airflow Variables" src="images/step-23.png" /></a></p>
<h4 id="39-replace-http-cli-connection-id">3.9. Replace HTTP CLI Connection ID  <a name="qz2M4CDztoNuib9xNbsya"></a></h4>
<p>Make sure to replace the current value of the 'http_conn_id' with the value <strong><em>chuck_norris_connection_YourCDPUsername </em></strong>used while creating the connection.</p>
<p><a class="glightbox" href="images/step-24.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Replace HTTP CLI Connection ID" src="images/step-24.png" /></a></p>
<h3 id="4-create-a-new-airflow-cde-job">4. Create a new Airflow CDE Job   <a name="yM_164r66HlG2UWMOW3xP"></a></h3>
<h4 id="41-select-jobs">4.1. Select Jobs   <a name="O-UCRC6f6hvtSH_2FnEXq"></a></h4>
<p>Navigate to the Jobs page by clicking on the <strong>Jobs</strong> in the main panel.</p>
<p><a class="glightbox" href="images/step-26.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Select Jobs " src="images/step-26.png" /></a></p>
<h4 id="42-click-on-create-job">4.2. Click on Create Job  <a name="EUgvw5oVrxv4BGyWVs2vH"></a></h4>
<p>Click on <strong>Create Job</strong> to create a new CDE Job.</p>
<p><a class="glightbox" href="images/step-27.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Click on Create Job" src="images/step-27.png" /></a></p>
<h4 id="43-fill-in-the-details">4.3. Fill in the details   <a name="JAIo4vHyaX0kMLi1EctYT"></a></h4>
<ul>
<li><strong>Job Type</strong>: Airflow</li>
<li><strong>Name</strong>: ChuckNorris_<strong><em>YourCDPUsername</em></strong></li>
<li><strong>Dag File</strong>: File</li>
<li>Upload <strong><em>http_dag.py</em></strong> to the <strong>firstdag</strong> CDE Resource you created earlier.</li>
</ul>
<p>Select '<strong>Create and Run</strong>' button to trigger the job immediately.</p>
<p><a class="glightbox" href="images/step-28.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Fill in the details " src="images/step-28.png" /></a></p>
<h4 id="44-job-run-in-progress">4.4. Job run in progress  <a name="6vLn-EkTTqD1fOPBwLBsE"></a></h4>
<p>Please wait for a min for job to run</p>
<p><a class="glightbox" href="images/step-29.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Job run in progress" src="images/step-29.png" /></a></p>
<h4 id="45-new-run-is-initiated">4.5. New run is initiated  <a name="xEGUDx0pSbKQiHWIsq4f_"></a></h4>
<div class="admonition success">
<p class="admonition-title">Success</p>
<p>A success message appears confirming that a new run with ID has been initiated. </p>
</div>
<p><a class="glightbox" href="images/step-30.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="New run is initiated" src="images/step-30.png" /></a></p>
<h4 id="46-review-the-jobs-in-progress">4.6. Review the Jobs in progress  <a name="zCGvrYZcJ6TOv6Jq_ZYie"></a></h4>
<p>Notice that two CDE Jobs are now in progress. One of them is <strong><em>"sparksq_dse_1_250204"</em></strong> (Spark CDE Job) and the other is <strong><em>"ChuckNorris_dse_1_250204"</em></strong> (Airflow CDE Job). The former has been triggered by the execution of the latter. Wait a few moments and allow for the DAG to complete.</p>
<p><a class="glightbox" href="images/step-31.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Review the Jobs in progress" src="images/step-31.png" /></a></p>
<h4 id="47-click-on-the-dag-link">4.7. Click on the Dag link  <a name="bd9WSCs2wvOutmlASx6GI"></a></h4>
<p>Once the Status column shows the Jobs run as succeeded, click on the "<strong>ChuckNorris_dse_1_250204</strong>" link to access the Job Run page.</p>
<p><a class="glightbox" href="images/step-32.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Click on the Dag link" src="images/step-32.png" /></a></p>
<h4 id="48-select-the-most-recent-run">4.8. Select the most recent Run  <a name="zBsDEuNZ7uMWWZgnmaT_S"></a></h4>
<p>This page shows each run along with associated logs, execution statistics, and the Airflow UI.</p>
<p>Ensure to select the most recent Run (in the screenshot, the most recent Run ID number is 72)</p>
<p><a class="glightbox" href="images/step-33.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Select the most recent Run" src="images/step-33.png" /></a></p>
<h4 id="49-review-job-run">4.9. Review Job Run  <a name="aXbyoGwfYDgT3vKOIhUPN"></a></h4>
<p>Review the Job Run. Notice the run id in the top section of the page. </p>
<p>Click on the Logs tab.</p>
<p><a class="glightbox" href="images/step-34.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Review Job Run" src="images/step-34.png" /></a></p>
<h4 id="410-select-dag-task">4.10. Select DAG Task   <a name="aj5H5yiWXJdiJkA-L3_Sd"></a></h4>
<p>Ensure to select the correct Airflow task which in this case is "<strong>chuck_norris_task</strong>":</p>
<p><a class="glightbox" href="images/step-35.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Select DAG Task " src="images/step-35.png" /></a></p>
<h4 id="411-review-dag-task">4.11.  Review DAG Task   <a name="-9bCqZSVoCYQLPSdlm0hz"></a></h4>
<p>Review the <strong>chuck_norris_task</strong> task</p>
<p>Scroll to the bottom and validate the output.</p>
<p><a class="glightbox" href="images/step-36.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt=" Review DAG Task " src="images/step-36.png" /></a></p>
<h3 id="5-using-xcoms">5. Using XComs  <a name="uFwjfoGv3nkqcOZ0cZcaf"></a></h3>
<p>Although the request in the prior step was successful the operator did not actually return the response to the DAG. XComs (short for “cross-communications”) are a mechanism that let Tasks talk to each other, as by default Tasks are entirely isolated and may be running on entirely different machines.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Practically XComs allow your operators to store results into a governed data structure and then reuse the values within the context of different operators. An XCom is identified by a key (essentially its name), as well as the task_id and dag_id it came from. They are only designed for small amounts of data; do not use them to pass around large values, like dataframes.</p>
</div>
<p>Open "xcom_dag.py" and familiarize yourself with the code. Notice the following changes in the code between lines 82 and 103:</p>
<h4 id="51-add-an-argument">5.1. Add an argument  <a name="PwHGXbrUYPOiU-2iNe1HE"></a></h4>
<p>At line 92 we added a "do_xcom_push=True" argument. This allows the response to be temporarily saved in the DAG.</p>
<p><a class="glightbox" href="images/step-38.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Add an argument" src="images/step-38.png" /></a></p>
<h4 id="52-add-python-method">5.2. Add python method  <a name="aSCNumMyWl3hbz-e-VQd3"></a></h4>
<p>At line 95 we introduced a new Python method "<em>print_chuck_norris_quote</em>" and at line 96 we use the built-in "<em>xcom_pull</em>" method to retrieve the temporary value from the <em>SimpleHttpOperator</em> task.</p>
<p><a class="glightbox" href="images/step-39.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Add python method" src="images/step-39.png" /></a></p>
<h4 id="53-declare-operator">5.3. Declare operator  <a name="pVo3wdV_-TVnmVUd2Zqrg"></a></h4>
<p>At line 62, we declared a new Python Operator running the method above.</p>
<div class="highlight"><pre><span></span><code>http_task = SimpleHttpOperator(
    task_id=&quot;chuck_norris_task&quot;,
    method=&quot;GET&quot;,
    http_conn_id=&quot;chuck_norris_connection&quot;,
    endpoint=&quot;/jokes/random&quot;,
    headers={&quot;Content-Type&quot;:&quot;application/json&quot;,
            &quot;X-RapidAPI-Key&quot;: api_key,
            &quot;X-RapidAPI-Host&quot;: api_host},
    response_check=lambda response: handle_response(response),
    dag=xcom_dag,
    do_xcom_push=True
)

def _print_chuck_norris_quote(**context):
    return context[&#39;ti&#39;].xcom_pull(task_ids=&#39;chuck_norris_task&#39;)

return_quote = PythonOperator(
    task_id=&quot;print_quote&quot;,
    python_callable=_print_chuck_norris_quote,
    dag=xcom_dag
)
</code></pre></div>
<p><a class="glightbox" href="images/step-40.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Declare operator" src="images/step-40.png" /></a></p>
<h4 id="54-replace-owner">5.4. Replace Owner  <a name="t94WcMTCqwBfGD1yPSL41"></a></h4>
<p>Make sure to replace the current value of the 'Owner' with your <strong><em>YourCDPUsername</em></strong> in the default arguments dictionary.</p>
<p><a class="glightbox" href="images/step-41.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Replace Owner" src="images/step-41.png" /></a></p>
<h4 id="55-replace-spark-job-name">5.5. Replace Spark job name  <a name="VbTI20QtmqJsAAkMsxoww"></a></h4>
<p>Make sure to replace the current value of the 'job_name' with <strong><em>sparksql_YourCDPUsername</em></strong> in spark_step block.</p>
<p><a class="glightbox" href="images/step-42.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Replace Spark job name" src="images/step-42.png" /></a></p>
<h4 id="56-replace-cli-connection-id">5.6. Replace CLI Connection ID  <a name="KQ2v85xnKBtvaV8tBPL4E"></a></h4>
<p>Make sure to replace the current value of the 'cli_conn_id' with the value <strong><em>cdw_connection_YourCDPUsername </em></strong>used while creating the connection.</p>
<p><a class="glightbox" href="images/step-43.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Replace CLI Connection ID" src="images/step-43.png" /></a></p>
<h4 id="57-replace-airflow-variables">5.7. Replace Airflow Variables  <a name="_XAAjdT7GOb57Za9aaQQJ"></a></h4>
<p>Make sure to replace the current value of the 'api_host' and api_key with the value <strong><em>rapids_api_host_YourCDPUsername </em></strong>and <strong><em>rapids_api_key_YourCDPUsername </em></strong>used while creating the variables.</p>
<p><a class="glightbox" href="images/step-44.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Replace Airflow Variables" src="images/step-44.png" /></a></p>
<h4 id="58-replace-http-cli-connection-id">5.8. Replace HTTP CLI Connection ID  <a name="Vma-hb1LKYKStZLuZZ8ST"></a></h4>
<p>Make sure to replace the current value of the 'http_conn_id' with the value <strong><em>chuck_norris_connection_YourCDPUsername </em></strong>used while creating the connection.</p>
<p><a class="glightbox" href="images/step-45.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Replace HTTP CLI Connection ID" src="images/step-45.png" /></a></p>
<h3 id="6-create-a-new-airflow-cde-job">6. Create a new Airflow CDE Job   <a name="hvpl95u0aQ6mal9vAFvAp"></a></h3>
<h4 id="61-select-jobs">6.1. Select Jobs  <a name="CkY38jEDUyg49XiUKjqGS"></a></h4>
<p>Navigate to the Jobs page by clicking on the <strong>Jobs</strong> in the main panel.</p>
<p><a class="glightbox" href="images/step-47.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Select Jobs" src="images/step-47.png" /></a></p>
<h4 id="62-click-on-create-job">6.2. Click on Create Job  <a name="4DqrAmpBA565IEYKUAFky"></a></h4>
<p>Click on <strong>Create Job</strong> to create a new CDE Job.</p>
<p><a class="glightbox" href="images/step-48.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Click on Create Job" src="images/step-48.png" /></a></p>
<h4 id="63-fill-in-the-details">6.3. Fill in the details   <a name="h_3m1jPaeRESZlI0ZmAPc"></a></h4>
<ul>
<li><strong>Job Type</strong>: Airflow</li>
<li><strong>Name</strong>: XcomDag_<strong><em>YourCDPUsername</em></strong></li>
<li><strong>Dag File</strong>: File</li>
<li>Upload <strong><em>xcom_dag.py</em></strong> to the <strong>firstdag</strong> CDE Resource you created earlier.</li>
</ul>
<p>Select '<strong>Create and Run</strong>' button to trigger the job immediately.</p>
<p><a class="glightbox" href="images/step-49.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Fill in the details " src="images/step-49.png" /></a></p>
<h4 id="64-job-run-in-progress">6.4. Job run in progress  <a name="qKXrr59ZHXZyJk-obuRH0"></a></h4>
<p>Please wait for a min for job to run</p>
<p><a class="glightbox" href="images/step-50.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Job run in progress" src="images/step-50.png" /></a></p>
<h4 id="65-new-run-is-initiated">6.5. New run is initiated  <a name="aAoBCAYZvVR8ox__LCEnu"></a></h4>
<div class="admonition success">
<p class="admonition-title">Success</p>
<p>A success message appears confirming that a new run with ID has been initiated. </p>
</div>
<p><a class="glightbox" href="images/step-51.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="New run is initiated" src="images/step-51.png" /></a></p>
<h4 id="66-review-the-jobs-in-progress">6.6. Review the Jobs in progress  <a name="6rNluqF9DWdEqSNHKjkl0"></a></h4>
<p>Notice that two CDE Jobs are now in progress. One of them is "<strong><em>sparksql_dse_1_250204</em></strong>" (Spark CDE Job) and the other is "<strong><em>XcomDag</em></strong><strong><em>s_dse_1_250204</em></strong>" (Airflow CDE Job). The former has been triggered by the execution of the latter. Wait a few moments and allow for the DAG to complete.</p>
<p><a class="glightbox" href="images/step-52.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Review the Jobs in progress" src="images/step-52.png" /></a></p>
<h4 id="67-click-on-the-firstdag-link">6.7. Click on the FirstDag link  <a name="0fW-O3yZOuYKbBuRNbSfb"></a></h4>
<p>Once the Status column shows the Jobs run as succeeded, click on the "<strong><em>XcomDag</em></strong><strong><em>s_dse_1_250204</em></strong>" link to access the Job Run page.</p>
<p><a class="glightbox" href="images/step-53.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Click on the FirstDag link" src="images/step-53.png" /></a></p>
<h4 id="68-select-the-most-recent-run">6.8. Select the most recent Run  <a name="SDHSqCkmGOaFg4YVUbUFA"></a></h4>
<p>This page shows each run along with associated logs, execution statistics, and the Airflow UI.</p>
<p>Ensure to select the most recent Run (in the screenshot, the most recent Run ID number is 98)</p>
<p><a class="glightbox" href="images/step-54.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Select the most recent Run" src="images/step-54.png" /></a></p>
<h4 id="69-review-job-run">6.9. Review Job Run  <a name="Wiwg8zoHTp6FSwJYWGlwq"></a></h4>
<p>Review the Job Run. Notice the run id in the top section of the page. </p>
<p>Click on the Logs tab.</p>
<p><a class="glightbox" href="images/step-55.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Review Job Run" src="images/step-55.png" /></a></p>
<h4 id="610-select-dag-task">6.10. Select DAG Task   <a name="y3g2MDaeju4orwaA7fgGn"></a></h4>
<p>Ensure to select the correct Airflow task which in this case is "<strong>print_quote</strong>":</p>
<p><a class="glightbox" href="images/step-56.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Select DAG Task " src="images/step-56.png" /></a></p>
<h4 id="611-review-dag-task">6.11. Review DAG Task  <a name="qm0eFCmvvJ9OyJz6oTLKq"></a></h4>
<p>Review the <strong><em>print_quote</em></strong> task</p>
<p>Scroll all the way down and validate that a Chuck Norris quote has been printed out. Which one did you get?</p>
<p><a class="glightbox" href="images/step-57.png" data-type="image" data-width="80%" data-height="auto" data-desc-position="bottom"><img alt="Review DAG Task" src="images/step-57.png" /></a></p>
<h3 id="7-end-of-the-exercise">7. End of the Exercise   <a name="jjxm0OCYYJ1zBkrqBU2CN"></a></h3>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Cloudera Inc. 2025
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "content.code.copy"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>